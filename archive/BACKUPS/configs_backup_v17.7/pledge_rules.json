{
  "schema": "v1",
  "states": ["promised","pending","received","lapsed","cancelled"],
  "defaults": { "currency": "USD", "grace_period_weeks": 4, "lapse_after_weeks": 16, "min_amount": 1000 },
  "stipulation_types": ["earmark_program","timeline_deadline","matching_funds","naming_rights","reporting_required"],
  "transitions": {
    "promised->pending":  { "on": "invoice_sent" },
    "pending->received":  { "on": "payment_cleared" },
    "pending->lapsed":    { "on": "deadline_missed", "after_weeks": 16 },
    "promised->cancelled":{"on": "donor_withdrawn" }
  },
  "matching_rules": { "allowed": true, "max_ratio": 3.0, "requires_counterparty": true },
  "notifications": { "pre_deadline_weeks": [8,2,1], "overdue_weeks": [1,2,4] }
}
